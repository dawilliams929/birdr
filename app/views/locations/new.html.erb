<p class="instructions">Place a marker on the map at the location.</p>
<%= form_for @location do |f| %>
	<div class="form-group col-md-4">
		<%= f.label :name %>
		<%= f.text_field :name, placeholder: "Enter the location's name", class: "form-control" %><br>
		<%= f.hidden_field :latitude %>
		<%= f.hidden_field :longitude %>
	
		<%= f.submit class: "btn btn-default" %>
	</div>
<% end %>
<style>
	html { height: 100% }
  body { height: 100%; margin: 0; padding: 0 }
	.container { height: 100% }
  #map-canvas { height: 400px; width: 600px }
</style>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCLWvfKjdHTctsb3rmEK7d7GMbzeV8WsuI&sensor=false"></script>
<script>
function populateLatLongFields(marker) {
	var position = marker.getPosition();
	var lat = position.lat();
	var lng = position.lng();
	document.getElementById('location_latitude').value = lat;
	document.getElementById('location_longitude').value = lng;
}

// function populateNameField(marker) {
// 	var name = $('.name_field').val();
// 	document.getElementById('location_name').value = name;
// }

function initialize() {
  var mapOptions = {
    zoom: 10,
    center: new google.maps.LatLng(37.65, -122.05)
  };
  var map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);
	var marker = new google.maps.Marker({
		map: map,
		draggable: true
	});
			
  google.maps.event.addListener(map, 'click', function (mouseEvent) {
		marker.setPosition(mouseEvent.latLng);
		
		google.maps.event.addListener(marker, 'dragend', function() {
			populateLatLongFields(marker);
		});
		
		// google.maps.event.addListener(marker, 'click', function() {
// 			infowindow.open(map,marker);
// 	  });	
		
		populateLatLongFields(marker);
		// populateNameField(marker);
  });
	
	// var contentString = '<p>Location name</p> + <textarea class="name_field">';
	//   var infowindow = new google.maps.InfoWindow({
	//   	content: contentString
	//   });
}

google.maps.event.addDomListener(window, 'load', initialize);
</script>

<div id="map-canvas"></div>