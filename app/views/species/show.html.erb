<%= render @species %>

<%= javascript_tag do %>
	var id = <%= params["id"] %>;
<% end %>

<style>
	html { height: 100% }
  body { height: 100%; margin: 0; padding: 0 }
  #map-canvas { height: 100% }
</style>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCLWvfKjdHTctsb3rmEK7d7GMbzeV8WsuI&sensor=false"></script>
<script>
	function initialize() {
  	var mapOptions = {
    	zoom: 9,
      center: new google.maps.LatLng(37.6, -122),
      mapTypeId: google.maps.MapTypeId.SATELLITE
  	};
    var map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);
    setMarkers(map);
  }
	
  function setMarkers(map) {
		var jsonUrl = "/species/" + id + ".json";
		$.getJSON(jsonUrl, function (data) {
			var locations = data.locations;
			$.each(locations, function(index, location) {
				var lat = location.latitude;
				var lng = location.longitude;
				var latLng = new google.maps.LatLng(lat, lng);
				
				var marker = new google.maps.Marker({
					position: latLng,
					map: map
				});
			});		
		});
 	}

  google.maps.event.addDomListener(window, 'load', initialize);
</script> 
<div id="map-canvas"></div>